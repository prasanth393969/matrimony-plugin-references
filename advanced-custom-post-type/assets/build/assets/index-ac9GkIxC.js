import{j as e,u as t}from"./fields-wnm5Jtc6.js";import{a as v,R as C}from"./vendor-D21mNUGX.js";import{n as V,f as re,s as ce,L as de}from"./Layout-CFk9FOHT.js";import{P as c,w as P,I as ue,A as he,s as A,B as J,a as be,u as _e,m as pe,c as me,ax as h,r as fe,cI as ge}from"./index-pmrLY__j.js";import{u as j,b as ve,a as xe,F as je}from"./index.esm-DCQn2FO4.js";import{T as ye,a as y}from"./index-D8v0Ahx2.js";import{C as k}from"./index-5Ilcd7WA.js";import{C as o}from"./CardRow-Bf5pkBel.js";import{S}from"./Select-DRmfXoMp.js";import{I as x}from"./Input-Cutb8bBf.js";import{T as g}from"./Toggle-DrKXNyA3.js";import{e as Ce}from"./validation-Dyv8Y-XS.js";import{M as ke}from"./index-76LCHVw3.js";const Se=[{label:"Default",value:"Default"},{label:"Inter",value:"Inter"},{label:"Lato",value:"Lato"},{label:"Open Sans",value:"Open Sans"},{label:"Poppins",value:"Poppins"},{label:"Roboto",value:"Roboto"},{label:"Ubuntu",value:"Ubuntu"}],Te=[{label:"Light",value:"light"},{label:"Dark",value:"dark"}],X=({language:r,font:s,skin:d,records_per_page:i,enable_beta:b,enable_log:u})=>{const m=document.globals,{register:a,formState:{errors:l}}=j();return e.jsxs(k,{children:[e.jsx(o,{label:t("Language"),value:e.jsx(S,{id:"language",label:t("Language"),placeholder:t("Set the language of the plug-in"),description:t("Set the language of the plug-in"),register:a,defaultValue:r,values:m.globals.available_languages,isRequired:!0,errors:l,validate:{required:"This field is mandatory"}})}),e.jsx(o,{label:t("Skin"),value:e.jsx(S,{id:"skin",label:t("Skin"),placeholder:t("Set the desired skin to be applied to the UI interface"),description:t("Set the desired skin to be applied to the UI interface"),register:a,defaultValue:d,values:Te,isRequired:!0,errors:l,validate:{required:"This field is mandatory"}})}),e.jsx(o,{label:t("Font"),value:e.jsx(S,{id:"font",label:t("Font"),placeholder:t("Set the font of the plug-in"),description:t("Set the font of the plug-in"),register:a,defaultValue:s,values:Se,isRequired:!0,errors:l,validate:{required:"This field is mandatory"}})}),e.jsx(o,{label:t("Records per page"),value:e.jsx(x,{type:"number",id:"records_per_page",description:t("Set the number of records per page in your ACPT dashboards."),register:a,errors:l,isRequired:!0,defaultValue:i,min:1,max:200,validate:{required:"This field is mandatory"}})}),e.jsx(o,{label:t("Enable logs"),value:e.jsx(g,{id:"enable_log",description:t("Turn on full logging to keep a detailed record of everything. This helps to spot bugs more easily and understand what went wrong if something breaks."),register:a,errors:l,defaultValue:u})}),e.jsx(o,{label:t("Enable beta versions"),value:e.jsx(g,{id:"enable_beta",description:t("Enable the download of beta versions."),register:a,errors:l,defaultValue:b})})]})};X.propTypes={language:c.string,font:c.string,enable_beta:c.bool,records_per_page:c.number};const ee=({enable_cpt:r,enable_tax:s,enable_op:d,enable_meta:i,enable_forms:b,enable_blocks:u})=>{const l=document.globals.globals.license_is_valid,{register:_,formState:{errors:p}}=j();return e.jsxs(k,{children:[e.jsx(o,{label:t("Enable custom post types"),value:e.jsx(g,{id:"enable_cpt",description:t("Enable the custom post types manager."),register:_,errors:p,defaultValue:r})}),e.jsx(o,{label:t("Enable taxonomies"),value:e.jsx(g,{id:"enable_tax",description:t("Enable the taxonomies manager."),register:_,errors:p,defaultValue:s})}),e.jsx(o,{label:t("Enable Option Pages"),value:e.jsx(g,{disabled:!l,id:"enable_op",description:t("Enable the Option Pages manager."),register:_,errors:p,defaultValue:d})}),e.jsx(o,{label:t("Enable meta fields"),value:e.jsx(g,{id:"enable_meta",description:t("Enable the meta fields manager."),register:_,errors:p,defaultValue:i})}),e.jsx(o,{label:t("Enable forms"),value:e.jsx(g,{disabled:!l,id:"enable_forms",description:t("Enable the form builder."),register:_,errors:p,defaultValue:b})}),e.jsx(o,{label:t("Enable dynamic blocks"),value:e.jsx(g,{disabled:!l,id:"enable_blocks",description:t("Enable the dynamic blocks manager."),register:_,errors:p,defaultValue:u})})]})};ee.propTypes={enable_cpt:c.bool,enable_tax:c.bool,enable_op:c.bool,enable_meta:c.bool,enable_blocks:c.bool,enable_forms:c.bool};const te=({google_maps_api_key:r,google_recaptcha_site_key:s,google_recaptcha_secret_key:d,cloudflare_turnstile_site_key:i,cloudflare_turnstile_secret_key:b})=>{const{register:u,formState:{errors:m}}=j();return e.jsxs(k,{children:[e.jsx(o,{label:t("Google Maps API key"),value:e.jsx(x,{id:"google_maps_api_key",description:t("Paste here your Google Maps API key. Needed to use the Address meta field."),register:u,errors:m,isRequired:!1,defaultValue:r,validate:{validate:Ce}})}),e.jsx(o,{label:t("Your Google reCAPTCHA site key"),value:e.jsx(x,{id:"google_recaptcha_site_key",description:t("Your Google reCAPTCHA site key. Needed to use the CAPTCHA form field."),register:u,errors:m,defaultValue:s,isRequired:!1})}),e.jsx(o,{label:t("Your Google reCAPTCHA secret key"),value:e.jsx(x,{id:"google_recaptcha_secret_key",description:t("Your Google reCAPTCHA secret key. Needed to use the CAPTCHA form field."),register:u,errors:m,defaultValue:d,isRequired:!1})}),e.jsx(o,{label:t("Your Cloudflare Turnstile site key"),value:e.jsx(x,{id:"cloudflare_turnstile_site_key",description:t("Your Cloudflare Turnstile site key. Needed to use the CAPTCHA form field."),register:u,errors:m,defaultValue:i,isRequired:!1})}),e.jsx(o,{label:t("Your Cloudflare Turnstile secret key"),value:e.jsx(x,{id:"cloudflare_turnstile_secret_key",description:t("Your Cloudflare Turnstile secret key. Needed to use the CAPTCHA form field."),register:u,errors:m,defaultValue:b,isRequired:!1})})]})};te.propTypes={google_maps_api_key:c.string,google_recaptcha_site_key:c.string,google_recaptcha_secret_key:c.string,cloudflare_turnstile_site_key:c.string,cloudflare_turnstile_secret_key:c.string};const Ae=[{label:"File system",value:"files"},{label:"Redis",value:"redis"},{label:"Memcached",value:"memcached"}],T=({driver:r})=>{const{control:s}=j(),d=ve({control:s,name:"cache_config"}),[i,b]=v.useState(!1),[u,m]=v.useState(null),[a,l]=v.useState(null),_=()=>{b(!i),P("cacheConnectionTestAction",{driver:r,config:d}).then(p=>{p.success?(l(!0),b(!1),m(t("Driver connection ok"))):(l(!1),b(!1),m(p.error))}).catch(p=>{m(p.message),l(!1),b(!1),console.error(p)})};return e.jsxs("div",{className:"mt-12",children:[u&&e.jsx("div",{className:`mb-12 color-${a?"success":"danger"}`,children:u}),!i&&e.jsx("a",{href:"#",onClick:p=>{p.preventDefault(),_()},children:t("Test driver connection")})]})};T.propTypes={driver:c.string,config:c.object};const se=({driver:r,config:s})=>{const{register:d,formState:{errors:i}}=j();if(r==="files")return e.jsx(o,{label:t("Cache folder settings"),value:e.jsxs(C.Fragment,{children:[e.jsx(x,{id:"cache_config.folder",description:t("Set the cache folder"),register:d,errors:i,isRequired:!0,defaultValue:(s==null?void 0:s.folder)??"cache",validate:{required:"This field is mandatory"}}),e.jsx(T,{driver:r,config:s})]})});if(r==="redis")return e.jsx(C.Fragment,{children:e.jsx(o,{label:t("Redis settings"),value:e.jsxs("div",{children:[e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"col-4",children:e.jsx(x,{id:"cache_config.redis_host",description:t("Set the Redis host"),register:d,errors:i,isRequired:!0,defaultValue:(s==null?void 0:s.redis_host)??"127.0.0.1",validate:{required:"This field is mandatory"}})}),e.jsx("div",{className:"col-4",children:e.jsx(x,{id:"cache_config.redis_port",description:t("Set the Redis port"),register:d,errors:i,isRequired:!0,defaultValue:(s==null?void 0:s.redis_port)??6379,validate:{required:"This field is mandatory"}})}),e.jsx("div",{className:"col-4",children:e.jsx(x,{type:"number",id:"cache_config.redis_database",description:t("Set the Redis database"),register:d,errors:i,isRequired:!0,defaultValue:(s==null?void 0:s.redis_database)??0,validate:{required:"This field is mandatory"}})})]}),e.jsx(T,{driver:r,config:s})]})})});if(r==="memcached")return e.jsx(C.Fragment,{children:e.jsx(o,{label:t("Memcached settings"),value:e.jsxs("div",{children:[e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"col-6",children:e.jsx(x,{id:"cache_config.memcached_host",description:t("Set the Memcached host"),register:d,errors:i,isRequired:!0,defaultValue:(s==null?void 0:s.memcached_host)??"127.0.0.1",validate:{required:"This field is mandatory"}})}),e.jsx("div",{className:"col-6",children:e.jsx(x,{id:"cache_config.memcached_port",description:t("Set the Memcached port"),register:d,errors:i,isRequired:!0,defaultValue:(s==null?void 0:s.memcached_port)??11211,validate:{required:"This field is mandatory"}})})]}),e.jsx(T,{driver:r,config:s})]})})})};se.propTypes={driver:c.string,config:c.object};const ae=({items:r})=>{const[s,d]=v.useState(!1),[i,b]=v.useState(r),[u,m]=v.useState(null),a=l=>{P("deleteCacheItemAction",{key:l}).then(_=>{_.success&&b(p=>p.filter(f=>f.key!==l))}).catch(_=>console.error(_))};return i?e.jsxs(C.Fragment,{children:[e.jsxs(ke,{size:"large",title:t("Manage cache items"),visible:s,buttons:[],children:[e.jsx("input",{type:"text",placeholder:t("Search an element saved in cache by its content."),className:"form-control mb-24",onChangeCapture:l=>{m(l.target.value)}}),(i==null?void 0:i.filter(l=>l.data.includes(u)).length)>0?e.jsxs("table",{className:"no-border-spacing with-border b-rounded w-100",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"p-8 b-bottom-1",children:t("Key")}),e.jsx("th",{className:"p-8 b-bottom-1",children:t("Data")}),e.jsx("th",{className:"p-8 b-bottom-1",children:t("Actions")})]}),i.filter(l=>l.data.includes(u)).map((l,_)=>e.jsxs("tr",{children:[e.jsx("td",{className:`vertical-top p-8 ${_!==i.length-1?"b-bottom-1":""}`,children:e.jsx("code",{className:"with-border b-rounded p-2 font-sm",children:l.key})}),e.jsx("td",{className:`vertical-top p-8 ${_!==i.length-1?"b-bottom-1":""}`,children:e.jsx("code",{style:{maxWidth:"300px"},className:"break-word font-sm",children:l.data})}),e.jsx("td",{className:`vertical-top p-8 ${_!==i.length-1?"b-bottom-1":""}`,children:e.jsx("a",{href:"#",onClick:p=>{p.preventDefault(),a(l.key)},children:e.jsx(ue,{icon:"bx-trash",width:18,color:"#F94144"})})})]},_))]}):e.jsx(he,{style:A.SECONDARY,children:t("No records found.")})]}),e.jsx("a",{href:"#",onClick:l=>{l.preventDefault(),d(!s)},children:t("Manage")})]}):null};ae.propTypes={items:c.array.isRequired};const Pe=()=>{var r;const[s,d]=v.useState(null);return v.useEffect(()=>{P("cacheStatsAction",{}).then(i=>{d(i)}).catch(i=>console.error(i))},[]),s?e.jsxs("table",{children:[e.jsxs("tr",{align:"left",children:[e.jsx("th",{className:"p-4 pl-0",children:t("INFO")}),e.jsx("td",{children:(s==null?void 0:s.info)??"--"})]}),e.jsxs("tr",{align:"left",children:[e.jsx("th",{className:"p-4 pl-0",children:t("SIZE")}),e.jsx("td",{children:(s==null?void 0:s.size)??"--"})]}),e.jsxs("tr",{align:"left",children:[e.jsx("th",{className:"p-4 pl-0",children:t("ITEMS")}),e.jsx("td",{children:e.jsxs("div",{className:"i-flex-center s-4",children:[e.jsx("span",{children:(s==null?void 0:s.itemsCount)??0}),(s==null||(r=s.items)===null||r===void 0?void 0:r.length)>0&&e.jsx(ae,{items:s==null?void 0:s.items})]})})]})]}):e.jsx("div",{children:t("Loading...")})},le=({enable_cache:r,enable_meta_cache:s,cache_driver:d,cache_config:i})=>{const[b,u]=v.useState(r),[m,a]=v.useState(d),{register:l,formState:{errors:_}}=j(),p=()=>{P("flushCacheAction",{}).then(f=>{f.success===!0?V.success(t("Cache was successfully flushed")):V.error(f.error)}).catch(f=>console.error(f))};return e.jsxs(k,{children:[e.jsx(o,{label:t("Enable ACPT cache"),value:e.jsx(g,{id:"enable_cache",description:t("Enable the ACPT cache. The cache stores the MySQL results in simple textual files to avoid useless DB calls."),register:l,errors:_,defaultValue:r,onChangeCapture:f=>{u(!b)}})}),b?e.jsxs(C.Fragment,{children:[e.jsx(o,{label:t("Enable cache for meta data"),value:e.jsx(g,{id:"enable_meta_cache",description:t("Enable cache for meta data"),register:l,errors:_,defaultValue:s})}),e.jsx(o,{label:t("Cache driver"),value:e.jsx(S,{id:"cache_driver",label:t("Cache driver"),placeholder:t("Set the desired cache driver to improve ACPT performances"),description:t("Set the desired cache driver to improve ACPT performances"),register:l,defaultValue:d,values:Ae,isRequired:!1,errors:_,onChangeCapture:f=>{a(f.target.value)}})}),e.jsx(se,{config:i,driver:m}),e.jsx(o,{label:t("Cache stats"),value:e.jsx(Pe,{})}),e.jsx(o,{label:t("Flush the ACPT cache"),value:e.jsx(J,{style:A.SECONDARY,onClick:f=>{f.preventDefault(),p()},children:t("Flush cache")})})]}):null]})};le.propTypes={enable_cache:c.bool,enable_meta_cache:c.bool,cache_driver:c.string,cache_config:c.object};const ie=({delete_unused_tables:r,delete_tables_when_deactivate:s,delete_posts:d,delete_metadata:i})=>{const{register:b,formState:{errors:u}}=j();return e.jsxs(k,{children:[e.jsx(o,{label:t("Delete unused MySQL tables"),value:e.jsx(g,{id:"delete_unused_tables",description:t("If this option is enabled, all MySQL tables that are not in use — such as forms and dynamic blocks — will be deleted. Enable this option only if you are sure of what you are doing!"),register:b,errors:u,defaultValue:r})}),e.jsx(o,{label:t("Delete ACPT definitions when deactivate the plug-in"),value:e.jsx(g,{id:"delete_tables_when_deactivate",description:t("Delete all saved ACPT definitions when you deactivate the plug-in. This means that if you select NO when you deactivate and then reactivate the plug-in you will find all the previously saved ACPT definitions (meta fields, options etc.)"),register:b,errors:u,defaultValue:s})}),e.jsx(o,{label:t("Delete posts when delete an ACPT post definition"),value:e.jsx(g,{id:"delete_posts",description:t("   Delete posts when delete an ACPT post type definition. This means that if you select YES, when you delete an ACPT post type definition all the saved posts will be deleted"),register:b,errors:u,defaultValue:d})}),e.jsx(o,{label:t("Delete metadata when delete an ACPT field"),value:e.jsx(g,{id:"delete_metadata",description:t("Delete post metadata when deleting an ACPT field. This means that if you select YES, when you delete an ACPT meta field all the saved metadata will be deleted"),register:b,errors:u,defaultValue:i})})]})};ie.propTypes={delete_unused_tables:c.bool,delete_tables_when_deactivate:c.bool,delete_posts:c.bool,delete_metadata:c.bool};const Oe=()=>{const{error:r,success:s,loading:d}=be(n=>n.saveSettings),i=_e(),[b,u]=v.useState(!1);v.useEffect(()=>{pe(t("Settings page")),me("#/settings"),re()},[]);const a=document.globals.settings,l=h("delete_metadata",a,0),_=h("delete_posts",a,0),p=h("delete_unused_tables",a,0),f=h("delete_tables_when_deactivate",a,0),E=h("enable_cache",a,1),N=h("enable_meta_cache",a,0),w=h("cache_driver",a,"files"),q=h("cache_config",a,{folder:"cache"}),D=h("enable_forms",a,0),I=h("enable_cpt",a,1),M=h("enable_tax",a,1),F=h("enable_op",a,1),L=h("enable_meta",a,1),Y=h("enable_blocks",a,0),G=h("font",a,"Inter"),O=h("skin",a,"light"),H=h("cloudflare_turnstile_site_key",a,""),U=h("cloudflare_turnstile_secret_key",a,""),$=h("google_recaptcha_site_key",a,""),z=h("google_recaptcha_secret_key",a,""),B=h("google_maps_api_key",a,""),Q=h("language",a,"en_US"),K=h("records_per_page",a,20),W=h("enable_beta",a,0),Z=h("enable_log",a,0),R=xe({mode:"all",defaultValues:{enable_log:Z,enable_beta:W,enable_cache:E,enable_meta_cache:N,cache_driver:w,cache_config:q,enable_forms:D,enable_blocks:Y,enable_cpt:I,enable_tax:M,enable_op:F,enable_meta:L,delete_metadata:l,delete_posts:_,delete_tables_when_deactivate:f,delete_unused_tables:p,records_per_page:K,google_maps_api_key:B,google_recaptcha_site_key:$,google_recaptcha_secret_key:z,cloudflare_turnstile_site_key:H,cloudflare_turnstile_secret_key:U,language:Q,skin:O,font:G}}),ne=n=>{i(ge({records_per_page:n.records_per_page,enable_log:n.enable_log?1:0,enable_beta:n.enable_beta?1:0,enable_cache:n.enable_cache?1:0,enable_meta_cache:n.enable_meta_cache?1:0,cache_driver:n.cache_driver,cache_config:n.cache_config,enable_forms:n.enable_forms?1:0,enable_blocks:n.enable_blocks?1:0,enable_cpt:n.enable_cpt?1:0,enable_tax:n.enable_tax?1:0,enable_op:n.enable_op?1:0,enable_meta:n.enable_meta?1:0,delete_unused_tables:n.delete_unused_tables?1:0,delete_tables_when_deactivate:n.delete_tables_when_deactivate?1:0,delete_posts:n.delete_posts?1:0,delete_metadata:n.delete_metadata?1:0,google_maps_api_key:n.google_maps_api_key,google_recaptcha_site_key:n.google_recaptcha_site_key,google_recaptcha_secret_key:n.google_recaptcha_secret_key,cloudflare_turnstile_site_key:n.cloudflare_turnstile_site_key,cloudflare_turnstile_secret_key:n.cloudflare_turnstile_secret_key,language:n.language?n.language:null,skin:n.skin?n.skin:null,font:n.font?n.font:null})),u(!0)};v.useEffect(()=>{b&&s&&(ce("Settings saved."),fe()),b&&r!==null&&V.error(r),b&&u(!1)},[d]);const oe=[e.jsx(J,{testId:"save-settings",style:A.PRIMARY,disabled:!!(!R.formState.isValid||d),children:d?t("Loading..."):t("Save")})];return e.jsx(je,{...R,children:e.jsx("form",{onSubmit:R.handleSubmit(ne),children:e.jsx(de,{crumbs:[{label:t("Settings")}],title:t("Settings"),actions:oe,children:e.jsxs(ye,{halfMargin:!0,children:[e.jsx(y,{title:t("General settings"),children:e.jsx(X,{font:G,skin:O,language:Q,records_per_page:K,enable_beta:W,enable_log:Z})}),e.jsx(y,{title:t("Content settings"),children:e.jsx(ee,{enable_cpt:I,enable_forms:D,enable_meta:L,enable_op:F,enable_tax:M,enable_blocks:Y})}),e.jsx(y,{title:t("Connect external services"),children:e.jsx(te,{google_maps_api_key:B,google_recaptcha_site_key:$,google_recaptcha_secret_key:z,cloudflare_turnstile_site_key:H,cloudflare_turnstile_secret_key:U})}),e.jsx(y,{title:t("Performances"),children:e.jsx(le,{enable_cache:E,enable_meta_cache:N,cache_driver:w,cache_config:q})}),e.jsx(y,{style:A.DANGER,title:t("Danger zone"),children:e.jsx(ie,{delete_unused_tables:p,delete_tables_when_deactivate:f,delete_posts:_,delete_metadata:l})})]})})})})};export{Oe as default};
