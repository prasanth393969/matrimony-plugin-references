import{useTranslation}from"./_admin_commons.min.js";import{initSortable}from"./_admin_sortable.min.js";var $=jQuery.noConflict();let handleListFieldsEvents=()=>{let l=t=>{0<t.length&&(t[0].scrollIntoView({behavior:"smooth"}),t.find(".list-element").first().focus())};document.addEventListener("keydown",t=>{var e;t.ctrlKey&&"ArrowUp"===t.key&&t.target.classList.contains("acpt-form-control")&&t.target.classList.contains("list-element")&&(t.stopPropagation(),t.preventDefault(),0<(e=$(t.target).closest("tr").prev("tr")).length)&&l(e),t.ctrlKey&&"ArrowDown"===t.key&&t.target.classList.contains("acpt-form-control")&&t.target.classList.contains("list-element")&&(t.stopPropagation(),t.preventDefault(),0<(e=$(t.target).closest("tr").next("tr")).length)&&l(e),t.ctrlKey&&"Delete"===t.key&&t.target.classList.contains("acpt-form-control")&&t.target.classList.contains("list-element")&&(t.stopPropagation(),t.preventDefault(),0<(e=$(t.target).closest("tr")).length)&&0<(e=e.find("a.list-remove-element")).length&&e.click(),t.ctrlKey&&"Enter"===t.key&&t.target.classList.contains("acpt-form-control")&&t.target.classList.contains("list-element")&&(t.stopPropagation(),t.preventDefault(),0<(e=$(t.target).closest("table")).length)&&0<(t=e.next(".list-add-element")).length&&t.click()}),$("body").on("click",".list-add-element",function(t){t.preventDefault();var t=$(this),e=t.data("target-id"),a=t.prev("table").children(".list-wrapper"),n=a.find("tr").length,t=t.data("parent-name"),e=(a.append(`
            <tr id="${t}_${n}" class="list-element sortable-li sortable-li-${e}">
                <td width="20">
                    <div class="handle">
                        .<br/>.<br/>.
                    </div>
                </td>
                <td>
                    <input id="${t}_${n}" name="${t}[]" type="text" class="acpt-form-control list-element">
                </td>
                <td width="100">
                    <a class="list-remove-element" data-index="${n}" data-parent-name="${t}" data-target-id="${t}_${n}" href="#">${useTranslation("Remove element")}</a>
                </td>
            </tr>
        `),a.find("tr").last());l(e),initSortable()}),$("body").on("click","a.list-remove-element",function(t){t.preventDefault();var t=$(this),e=t.data("target-id"),t=t.data("index"),e=document.getElementById(e),a=$(e).closest("table");e&&e.remove(),0<a.length&&(e=a.find("tr").get(t-1),a=$(e),l(a))})};export{handleListFieldsEvents};