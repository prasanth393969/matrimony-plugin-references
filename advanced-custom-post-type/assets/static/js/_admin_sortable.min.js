import{destroyTinyMCE,initTinyMCE}from"./_admin_editor.min.js";var $=jQuery.noConflict();let initSortable=()=>{try{"undefined"!=typeof sortable&&($(".playlist-preview").length&&(sortable(".playlist-preview",{acceptFrom:".playlist-preview",forcePlaceholderSize:!0,items:".audio",hoverClass:"hover",copy:!1}),$(".playlist-preview").each(function(e){let s=e;sortable(".playlist-preview")[e]&&sortable(".playlist-preview")[e].addEventListener("sortupdate",function(e){e=e.detail.destination.items;let t=[];e.map(e=>{t.push($(e).data("index"))});var a=$(this).data("target"),i=$("#"+a+"_copy");let r;r=0<$("#"+a+"_attachment_id").length?$("#"+a+"_attachment_id"):$("#"+a+"\\[attachment_id\\]\\["+s+"\\]");a=i.next(".inputs-wrapper");r.val().split(","),i.val().split(",");let l=a.children("input"),n=[],o=[],d=[];e.map(e=>{let t=$(e).data("index");var e=$(e).find("audio"),a=e.attr("src"),e=e.data("id");n.push(e),o.push(a),l.each(function(){$(this).data("index")===t&&d.push($(this))})}),r.val(n.join(",")),i.val(o.join(",")),0<i.length&&i[0].dispatchEvent(new Event("change")),a.html(d)})}),sortable(".playlist-preview","reload")),$(".gallery-preview").length&&(sortable(".gallery-preview",{acceptFrom:".gallery-preview",forcePlaceholderSize:!0,items:".image",hoverClass:"hover",copy:!1}),$(".gallery-preview").each(function(e){let d=e;sortable(".gallery-preview")[e]&&sortable(".gallery-preview")[e].addEventListener("sortupdate",function(e){var e=e.detail.destination.items,t=$(this).data("target"),a=$("#"+t+"_copy");let i;i=0<$("#"+t+"_attachment_id").length?$("#"+t+"_attachment_id"):$("#"+t+"\\[attachment_id\\]\\["+d+"\\]");t=a.next(".inputs-wrapper");i.val().split(","),a.val().split(",");let r=t.children("input"),l=[],n=[],o=[];e.map(e=>{let t=$(e).data("index");var e=$(e).find("img"),a=e.attr("src"),e=e.data("id");l.push(e),n.push(a),r.each(function(){$(this).data("index")===t&&o.push($(this))})}),i.val(l.join(",")),a.val(n.join(",")),0<a.length&&a[0].dispatchEvent(new Event("change")),t.html(o)})}),sortable(".gallery-preview","reload")),0<$(".acpt-sortable").length&&$(".acpt-sortable").each(function(e){let a=$(this).attr("id"),t=a.replace("acpt-sortable-","");a.includes("selected_items_")&&(t=a.replace("selected_items_","")),sortable("#"+a,{acceptFrom:"#"+a,forcePlaceholderSize:!0,items:".sortable-li-"+t,handle:".handle",hoverClass:"hover",copy:!1})[0].addEventListener("sortupdate",function(e){var t=new CustomEvent("acpt_grouped_element_sorted",{detail:{elementId:a}});document.dispatchEvent(t)}),sortable("#"+a,"reload"),sortable("#"+a)[e]&&sortable("#"+a)[e].addEventListener("sortupdate",function(e){e.detail.item.id&&(e=$("#"+e.detail.item.id).find("textarea.acpt-wp-editor"))&&(destroyTinyMCE(e.attr("id")),initTinyMCE(e.attr("id"),e.attr("rows"),e.data("toolbar")))})}),0<$(".acpt-nested-sortable").length)&&$(".acpt-nested-sortable").each(function(e){var t=$(this).attr("id"),a=t.replace("block-elements-","");sortable("#"+t,{acceptFrom:"#"+t,forcePlaceholderSize:!0,items:".sortable-li-"+a,handle:".handle",hoverClass:"hover",copy:!1})[0].addEventListener("sortupdate",function(e){var t=new Event("acpt_grouped_element_sorted");document.dispatchEvent(t)}),sortable("#"+t,"reload"),sortable("#"+t)[e]&&sortable("#"+t)[e].addEventListener("sortupdate",function(e){e.detail.item.id&&(e=$("#"+e.detail.item.id).find("textarea.acpt-wp-editor"))&&(destroyTinyMCE(e.attr("id")),initTinyMCE(e.attr("id",e.attr("rows"),e.data("toolbar"))))})})}catch(e){console.error(e)}};export{initSortable};